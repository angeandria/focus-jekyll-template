{% assign desc_content = include.content %}

{% assign filters = site.data.focus.code-filters %} <!-- Assuming you have a YAML file with filter configurations -->

{% assign filtered_results = "" %}

{% for filter in filters %}

    {% assign code_marker = filter.marker | default: 'CODE' %}                      {% comment %} CODE {% endcomment %}
    {% assign code_marker_start_final = code_marker | append : '__START' %}         {% comment %} CODE__START {% endcomment %}
    {% assign code_marker_end_final = code_marker | append : '__END' %}             {% comment %} CODE__END {% endcomment %}

    {% comment %}
    {% assign code_marker_start_final = filter.marker_start | default: code_marker_start_final %}
    {% assign code_marker_end_final = filter.marker_end | default: code_marker_end_final %}
    {% endcomment %}
    
    {% assign code_marker_start = filter.marker_start | default: '{' %}             {% comment %} '{'' {% endcomment %}
    {% assign code_marker_start = code_marker_start | append : code_marker %}       {% comment %} {CODE {% endcomment %}
    {% assign code_marker_end = filter.marker_end | default: '}' %}                 {% comment %} '}' {% endcomment %}
    {% assign code_marker_end = code_marker | append: code_marker_end %}            {% comment %} {CODE {% endcomment %}
    {% assign code_delimiter = filter.delimiter | default: '' %}                    {% comment %} '' {% endcomment %}
    
    {% assign code_replacement = filter.replacement | default: '' %}                {% comment %} '' {% endcomment %}
    
    <p>marker : {{ code_marker }}, start_final : {{ code_marker_start_final }}, start_end : {{ code_marker_end_final }}</p>
    <p>start : {{ code_marker_start }}, end : {{ code_marker_end }}, delimiter : {{ code_delimiter }}</p>
    <p>replacement : {{ code_replacement }}</p>
    
    {% assign modified_content = desc_content | replace: code_delimiter, code_marker %}
    {% assign modified_content = modified_content | replace: code_marker_start, code_marker_start_final %}
    {% assign modified_content = modified_content | replace: code_marker_end, code_marker_end_final %}wo
    
    {% assign parts = modified_content | split: code_marker_start_final %}

    {% assign filtered_content = parts[0] %}
    
    {% for part in parts %}
        {% if forloop.first %}
            {% continue %}
        {% else %}
            {% assign sub_parts = part | split: code_marker_end_final %}
            {% assign filtered_content = filtered_content | append: code_replacement %}
            
            {% if sub_parts.size > 1 %}
                {% assign filtered_content = filtered_content | append: sub_parts[1] %}
            {% endif %}
        {% endif %}
    {% endfor %}
    
    {% assign filtered_results = filtered_results | append: filtered_content %} <!-- Concatenating results -->
{% endfor %}

<!-- Convert Markdown content to HTML -->
{% assign filtered_html = filtered_results | markdownify %}
{% assign paragraphs = filtered_html | split: '</p>' %}
{% assign first_paragraph = "" %}
{% for paragraph in paragraphs %}
    {% if paragraph contains '<p>' %}
        {% assign first_paragraph = paragraph | remove: '<p>' %}
        {% break %}
    {% endif %}
{% endfor %}

<div>
    {{ first_paragraph | strip_html }}
</div>